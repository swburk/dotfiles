#!/bin/bash

dotfiles="$HOME/.dotfiles"
pushd "$dotfiles" >/dev/null
for f in *; do
    if [[ -d "$f" ]]; then
        [[ ! -d "$HOME/.$f" ]] && mkdir "$HOME/.$f"
        echo "linking $f"
        for c in "$f"/*; do
            [[ -e "$HOME/.$c" ]] && rm -r "$HOME/.$c"
            ln -s "$dotfiles/$c" "$HOME/.$c"
        done
    elif [[ ! "$f" =~ ^(install|README.md)$ ]]; then
        echo "linking $f"
        ln -sf "$dotfiles/$f" "$HOME/.$f"
    fi
done
git submodule update --init
popd >/dev/null
